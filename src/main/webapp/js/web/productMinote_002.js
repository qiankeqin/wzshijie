XIAOMI.namespace("products"),XIAOMI.products=function(){function a(b,c){return c=c>b.length?b.length:c,0>c?0:a(b,c-1)+b[c]}function b(a){return"number"==typeof a&&isFinite(a)&&a%1===0}function c(a,b,c){var d,e,f,g;d={triggerSelectorIndex:0,tabSelector:".tab",containerSelector:".tab-container",contentSelector:".tab-content",callback:function(){}},e=$.extend({},d,c),f=$(a),g=f.first().attr("data-tab-target")?$("#"+f.first().attr("data-tab-target")):f.first().siblings(e.containerSelector),b="number"==typeof b?b:0,f.each(function(){$(this).children(e.tabSelector).eq(b).addClass("tab-active").siblings(e.tabSelector).removeClass("tab-active")}),g.children(e.contentSelector).eq(b).addClass("tab-content-active").show().siblings(e.contentSelector).removeClass("tab-content-active").hide(),"function"==typeof e.callback&&e.callback(f,b,e)}function d(a,b){var e,f,g;if(e={isSync:!1,events:"click",tabSelector:".tab",containerSelector:".tab-container",contentSelector:".tab-content",after:function(){}},f=$.extend({},e,b),g=$(a),f.isSync===!1){if(0===g.length)return g;if(g.length>1)return g.each(function(){d($(this),b)}),g}g.each(function(a){var b=$(this);f=$.extend(f,{triggerSelectorIndex:a}),b.children(f.tabSelector).on(f.events,function(a){var d=b.children(f.tabSelector).index($(this));if(a.preventDefault(),$(this).attr("href")&&$(this).attr("href").split("#")[1]){var e=$(window).scrollTop();window.location.hash=$(this).attr("href").split("#")[1],$("body, html").scrollTop(e)}c(g,d,f),"function"==typeof f.after&&f.after(g,d,f)})})}function e(b,c){function d(){var a=-1;return $(m).each(function(b){return n+j-m[b]>0?void(a+=1):!1}),0>a?!1:void(i.eq(a).hasClass("xm-visible-section")||(g.onlyOneVisible&&i.removeClass("xm-visible-section"),i.eq(a).addClass("xm-visible-section"),"function"==typeof g.onVisible&&g.onVisible(a)))}var f,g,h,i,j,k=$(b),l=[],m=[],n=0;if(0===k.length)return b;if(k.length>1)return k.each(function(){e($(this),c)}),k;f={selector:".section",viewport:$(window),sectionOffsetFix:300,onlyOneVisible:!1,onLoad:function(){},onVisible:function(){}},g=$.extend({},f,c),i=k.children(g.selector),h=k.addClass("xm-visible-section-container").offset().top,n=$(document).scrollTop()-h,j=g.viewport.height(),i.each(function(){l.push($(this).height())});for(var o=0;o<l.length;o+=1){var p=i.eq(o).attr("data-offset-fix")?parseInt(i.eq(o).attr("data-offset-fix")):g.sectionOffsetFix;m[o]=a(l,o-1)+p}"function"==typeof g.onLoad&&g.onLoad(),$(window).on({"resize.visible":function(){j=$(window).height(),d()},"scroll.visible":function(){n=$(document).scrollTop()-h,d()}}),$(document).ready(function(){d()})}function f(a,c){function d(a,c){return b(a)?a:a.toFixed(c)}function e(){if(1e3*l/h.time>100){var a=Math.floor(l/50);k*=a,l/=a,e()}}var g,h,i,j,k,l,m,n=$(a);return 0===n.length?a:n.length>1?(n.each(function(){f($(this),c)}),n):(g={stepBase:1,startNum:0,fixed:1,time:1e3},h=$.extend({},g,c),j=Number(n.attr("data-end-number"))||Number(n.text()),j&&0!==j?(i=h.startNum,!b(j)&&b(h.stepBase)?(k=.1*h.stepBase,l=Math.ceil(j/k)):(k=1*h.stepBase,l=Math.ceil(j/k)),e(),n.text(i),void(m=window.setInterval(function(){i+=k,l-=1,n.text(d(i,h.fixed)),1>l&&(window.clearInterval(m),n.text(j))},h.time/l))):!1)}function g(){var a=$(".container").width();a>930?$(".J_discuzz").show():$(".J_discuzz").hide()}function h(){g(),$(window).on("resize",function(){g()})}function i(){function a(a,c){try{if(b&&b.trigger)return"string"!=typeof c&&(c=JSON.stringify(c)),b.trigger(a,c)}catch(d){}return!1}var b=window.WE||window.WE_PAD;/mi pad/i.test(navigator.userAgent)&&b&&($(document.body).css("padding","75px 0 0"),$(document.head).append('<meta name="viewport" content="width=device-width, user-scalable=no" />'),$(".site-topbar, .site-header, .site-footer").hide(),$(".J_linkFcode").removeAttr("target").attr("href","http://m.mi.com/pad/queue/f2code.html"),$(".J_productStockStatus").removeAttr("target").on("click",function(b){b.preventDefault(),a("opennew","http://hd.mi.com/f/zt/open/cn/index.html")}))}function j(){i()}var k=function(){var a=document.createElement("p").style,b=["ms","O","Moz","Webkit"];if(""===a.transition)return!0;for(;b.length;)return b.pop()+"Transition"in a?!0:!1}(),l=function(){return!!document.createElement("video").canPlayType}(),m=/constructor/i.test(window.HTMLElement),n=/android/i.test(navigator.userAgent.toLowerCase());return h(),{supportsTransitions:k,supportsVideo:l,isSafari:m,isAndroid:n,switchSection:c,tabSwitch:d,visibleWatcher:e,jumpNumber:f,init:j}}(),jQuery(function(){XIAOMI.products.init()});